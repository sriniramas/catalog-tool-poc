{"version":3,"file":"position.js","sourceRoot":"","sources":["../src/utils/position.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Utilites to manipulate the position of elements relative to other elements\n *\n */\n\nimport { getScrollbarWidth } from \"./window-tools\";\n\n// possible positions ... this should probably be moved (along with some other types) to some central location\nexport type Placement =\n\t\"left\" | \"right\" | \"top\" | \"bottom\" | \"top-left\" | \"top-right\" | \"bottom-left\" | \"bottom-right\" | \"left-bottom\" | \"right-bottom\";\n\nexport interface AbsolutePosition {\n\ttop: number;\n\tleft: number;\n\tposition?: AbsolutePosition;\n}\n\nexport type Offset = { left: number, top: number };\n\nfunction calculatePosition(referenceOffset: Offset, reference: HTMLElement, target: HTMLElement, placement: Placement): AbsolutePosition {\n\t// calculate offsets for a given position\n\tconst referenceRect = reference.getBoundingClientRect();\n\tswitch (placement) {\n\t\tcase \"left\":\n\t\t\treturn {\n\t\t\t\ttop: referenceOffset.top - Math.round(target.offsetHeight / 2) + Math.round(referenceRect.height / 2),\n\t\t\t\tleft: Math.round(referenceOffset.left - target.offsetWidth)\n\t\t\t};\n\t\tcase \"right\":\n\t\t\treturn {\n\t\t\t\ttop: referenceOffset.top - Math.round(target.offsetHeight / 2) + Math.round(referenceRect.height / 2),\n\t\t\t\tleft: Math.round(referenceOffset.left + referenceRect.width)\n\t\t\t};\n\t\tcase \"top\":\n\t\t\treturn {\n\t\t\t\ttop: Math.round(referenceOffset.top - target.offsetHeight),\n\t\t\t\tleft: referenceOffset.left - Math.round(target.offsetWidth / 2) + Math.round(referenceRect.width / 2)\n\t\t\t};\n\t\tcase \"bottom\":\n\t\t\treturn {\n\t\t\t\ttop: Math.round(referenceOffset.top + referenceRect.height),\n\t\t\t\tleft: referenceOffset.left - Math.round(target.offsetWidth / 2) + Math.round(referenceRect.width / 2)\n\t\t\t};\n\t\tcase \"left-bottom\":\n\t\t\treturn {\n\t\t\t\t// 22 == half of popover header height\n\t\t\t\ttop: referenceOffset.top - 22 + Math.round(referenceRect.height / 2),\n\t\t\t\tleft: Math.round(referenceOffset.left - target.offsetWidth)\n\t\t\t};\n\t\tcase \"right-bottom\":\n\t\t\treturn {\n\t\t\t\ttop: referenceOffset.top - 22 + Math.round(referenceRect.height / 2),\n\t\t\t\tleft: Math.round(referenceOffset.left + referenceRect.width)\n\t\t\t};\n\t\t// matter currently doesn't support these, so the popover is broken anyway\n\t\tcase \"top-left\":\n\t\t\treturn {\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t};\n\t\tcase \"top-right\":\n\t\t\treturn {\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t};\n\t\tcase \"bottom-left\":\n\t\t\treturn {\n\t\t\t\ttop: referenceOffset.top + referenceRect.height,\n\t\t\t\tleft: referenceOffset.left + referenceRect.width - target.offsetWidth\n\t\t\t};\n\t\tcase \"bottom-right\":\n\t\t\treturn {\n\t\t\t\ttop: referenceOffset.top + referenceRect.height,\n\t\t\t\tleft: referenceOffset.left\n\t\t\t};\n\t}\n}\n\nexport namespace position {\n\texport function getRelativeOffset(target: HTMLElement): Offset {\n\t\t// start with the inital element offsets\n\t\tlet offsets = {\n\t\t\tleft: target.offsetLeft,\n\t\t\ttop: target.offsetTop\n\t\t};\n\t\t// get each static (i.e. not absolute or relative) offsetParent and sum the left/right offsets\n\t\twhile (target.offsetParent && getComputedStyle(target.offsetParent).position === \"static\") {\n\t\t\toffsets.left += target.offsetLeft;\n\t\t\toffsets.top += target.offsetTop;\n\t\t\ttarget = target.offsetParent as HTMLElement;\n\t\t}\n\t\treturn offsets;\n\t}\n\n\texport function getAbsoluteOffset(target: HTMLElement): Offset {\n\t\treturn {\n\t\t\ttop: target.getBoundingClientRect().top,\n\t\t\tleft: target.getBoundingClientRect().left - document.body.getBoundingClientRect().left\n\t\t};\n\t}\n\n\t// finds the position relative to the `reference` element\n\texport function findRelative(reference: HTMLElement, target: HTMLElement, placement: Placement): AbsolutePosition {\n\t\tconst referenceOffset = getRelativeOffset(reference);\n\t\treturn calculatePosition(referenceOffset, reference, target, placement);\n\t}\n\n\texport function findAbsolute(reference: HTMLElement, target: HTMLElement, placement: Placement): AbsolutePosition {\n\t\tconst referenceOffset = getAbsoluteOffset(reference);\n\t\treturn calculatePosition(referenceOffset, reference, target, placement);\n\t}\n\n\texport function findPosition(reference: HTMLElement,\n\t\ttarget: HTMLElement,\n\t\tplacement: Placement,\n\t\toffsetFunction = getRelativeOffset): AbsolutePosition {\n\t\tconst referenceOffset = offsetFunction(reference);\n\t\treturn calculatePosition(referenceOffset, reference, target, placement);\n\t}\n\n\t/**\n\t * Get the dimensions of the dialog from an AbsolutePosition and a reference element\n\t */\n\texport function getPlacementBox(target: HTMLElement, position: AbsolutePosition) {\n\t\tconst targetBottom = target.offsetHeight + position.top;\n\t\tconst targetRight = target.offsetWidth + position.left;\n\n\t\treturn {\n\t\t\ttop: position.top,\n\t\t\tbottom: targetBottom,\n\t\t\tleft: position.left,\n\t\t\tright: targetRight\n\t\t};\n\t}\n\n\texport function addOffset(position: AbsolutePosition, top = 0, left = 0): AbsolutePosition {\n\t\treturn Object.assign({}, position, {\n\t\t\ttop: position.top + top,\n\t\t\tleft: position.left + left\n\t\t});\n\t}\n\n\texport function setElement(element: HTMLElement, position: AbsolutePosition): void {\n\t\telement.style.top = `${position.top}px`;\n\t\telement.style.left = `${position.left}px`;\n\t}\n}\n\nexport default position;\n"]}